(function(a){a.fn.lightBox=function(b){b=jQuery.extend({overlayBgColor:"#000",overlayOpacity:.8,fixedNavigation:false,imageLoading:"images/lightbox-ico-loading.gif",imageBtnPrev:"images/lightbox-btn-prev.gif",imageBtnNext:"images/lightbox-btn-next.gif",imageBtnClose:"images/lightbox-btn-close.gif",imageBlank:"images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},b);var l=this;function q(){s(this,l);return false}function s(f,d){a("embed, object, select").css({visibility:"hidden"});p();b.imageArray.length=0;b.activeImage=0;if(d.length==1)b.imageArray.push([f.getAttribute("href"),f.getAttribute("title")]);else for(var e=0;e<d.length;e++)b.imageArray.push([d[e].getAttribute("href"),d[e].getAttribute("title")]);while(b.imageArray[b.activeImage][0]!=f.getAttribute("href"))b.activeImage++;c()}function p(){a("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+b.imageLoading+'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+b.imageBtnClose+'"></a></div></div></div></div>');var c=g();a("#jquery-overlay").css({backgroundColor:b.overlayBgColor,opacity:b.overlayOpacity,width:c[0],height:c[1]}).fadeIn();var e=f();a("#jquery-lightbox").css({top:e[1]+c[3]/10,left:e[0]}).show();a("#jquery-overlay,#jquery-lightbox").click(function(){d()});a("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){d();return false});a(window).resize(function(){var b=g();a("#jquery-overlay").css({width:b[0],height:b[1]});var c=f();a("#jquery-lightbox").css({top:c[1]+b[3]/10,left:c[0]})})}function c(){a("#lightbox-loading").show();if(b.fixedNavigation)a("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();else a("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var c=new Image;c.onload=function(){a("#lightbox-image").attr("src",b.imageArray[b.activeImage][0]);j(c.width,c.height);c.onload=function(){}};c.src=b.imageArray[b.activeImage][0]}function j(d,c){var i=a("#lightbox-container-image-box").width(),g=a("#lightbox-container-image-box").height(),f=d+b.containerBorderSize*2,e=c+b.containerBorderSize*2,k=i-f,j=g-e;a("#lightbox-container-image-box").animate({width:f,height:e},b.containerResizeSpeed,function(){r()});if(k==0&&j==0)if(a.browser.msie)h(250);else h(100);a("#lightbox-container-image-data-box").css({width:d});a("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:c+b.containerBorderSize*2})}function r(){a("#lightbox-loading").hide();a("#lightbox-image").fadeIn(function(){n();o()});k()}function n(){a("#lightbox-container-image-data-box").slideDown("fast");a("#lightbox-image-details-caption").hide();b.imageArray[b.activeImage][1]&&a("#lightbox-image-details-caption").html(b.imageArray[b.activeImage][1]).show();b.imageArray.length>1&&a("#lightbox-image-details-currentNumber").html(b.txtImage+" "+(b.activeImage+1)+" "+b.txtOf+" "+b.imageArray.length).show()}function o(){a("#lightbox-nav").show();a("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+b.imageBlank+") no-repeat"});if(b.activeImage!=0)if(b.fixedNavigation)a("#lightbox-nav-btnPrev").css({background:"url("+b.imageBtnPrev+") left 15% no-repeat"}).unbind().bind("click",function(){b.activeImage=b.activeImage-1;c();return false});else a("#lightbox-nav-btnPrev").unbind().hover(function(){a(this).css({background:"url("+b.imageBtnPrev+") left 15% no-repeat"})},function(){a(this).css({background:"transparent url("+b.imageBlank+") no-repeat"})}).show().bind("click",function(){b.activeImage=b.activeImage-1;c();return false});if(b.activeImage!=b.imageArray.length-1)if(b.fixedNavigation)a("#lightbox-nav-btnNext").css({background:"url("+b.imageBtnNext+") right 15% no-repeat"}).unbind().bind("click",function(){b.activeImage=b.activeImage+1;c();return false});else a("#lightbox-nav-btnNext").unbind().hover(function(){a(this).css({background:"url("+b.imageBtnNext+") right 15% no-repeat"})},function(){a(this).css({background:"transparent url("+b.imageBlank+") no-repeat"})}).show().bind("click",function(){b.activeImage=b.activeImage+1;c();return false});i()}function i(){a(document).keydown(function(a){m(a)})}function e(){a(document).unbind()}function m(a){if(a==null){keycode=event.keyCode;escapeKey=27}else{keycode=a.keyCode;escapeKey=a.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();(key==b.keyToClose||key=="x"||keycode==escapeKey)&&d();if(key==b.keyToPrev||keycode==37)if(b.activeImage!=0){b.activeImage=b.activeImage-1;c();e()}if(key==b.keyToNext||keycode==39)if(b.activeImage!=b.imageArray.length-1){b.activeImage=b.activeImage+1;c();e()}}function k(){if(b.imageArray.length-1>b.activeImage){objNext=new Image;objNext.src=b.imageArray[b.activeImage+1][0]}if(b.activeImage>0){objPrev=new Image;objPrev.src=b.imageArray[b.activeImage-1][0]}}function d(){a("#jquery-lightbox").remove();a("#jquery-overlay").fadeOut(function(){a("#jquery-overlay").remove()});a("embed, object, select").css({visibility:"visible"})}function g(){var c,d;if(window.innerHeight&&window.scrollMaxY){c=window.innerWidth+window.scrollMaxX;d=window.innerHeight+window.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){c=document.body.scrollWidth;d=document.body.scrollHeight}else{c=document.body.offsetWidth;d=document.body.offsetHeight}var a,b;if(self.innerHeight){if(document.documentElement.clientWidth)a=document.documentElement.clientWidth;else a=self.innerWidth;b=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){a=document.documentElement.clientWidth;b=document.documentElement.clientHeight}else if(document.body){a=document.body.clientWidth;b=document.body.clientHeight}if(d<b)pageHeight=b;else pageHeight=d;if(c<a)pageWidth=c;else pageWidth=a;arrayPageSize=[pageWidth,pageHeight,a,b];return arrayPageSize}function f(){var a,b;if(self.pageYOffset){b=self.pageYOffset;a=self.pageXOffset}else if(document.documentElement&&document.documentElement.scrollTop){b=document.documentElement.scrollTop;a=document.documentElement.scrollLeft}else if(document.body){b=document.body.scrollTop;a=document.body.scrollLeft}arrayPageScroll=[a,b];return arrayPageScroll}function h(c){var b=new Date;a=null;do var a=new Date;while(a-b<c)}return this.unbind("click").click(q)}})(jQuery)